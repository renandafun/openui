Imports System.Data.OleDb
Imports System.Windows.Forms.VisualStyles.VisualStyleElement

Public Class Form2
    Dim da As New OleDbDataAdapter
    Dim dset As New DataSet
    Dim i As Integer
    Dim cmd As OleDbCommand
    Dim dr As OleDbDataReader
    Dim sql As String
    Dim item1 As ListViewItem

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim sql As String
        Dim cmd As New OleDb.OleDbCommand
        conn.Open()
        sql = "INSERT INTO tblRegistration (ISBN,Title,Authour,Publication,NoCopies) values ('" & TextBox1.Text & "', '" & TextBox2.Text & "','" & TextBox3.Text & "','" & TextBox4.Text & "','" & TextBox5.Text & "');"
        cmd.Connection = conn
        cmd.CommandText = sql
        i = cmd.ExecuteNonQuery
        conn.Close()
        If i > 0 Then
            MsgBox("New record has been saved!")
        Else
            MsgBox("No record has been saved!")
        End If
        If conn.State = ConnectionState.Open Then
            conn.Close()
        End If

    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim cmd As OleDbCommand
        Dim dr As OleDbDataReader
        Dim sql As String

        conn.Open()
        sql = "Select * from tblRegistration WHERE ISBN='" & TextBox1.Text & "'"
        cmd = New OleDbCommand(sql, conn)
        dr = cmd.ExecuteReader()
        TextBox2.Text = ""
        TextBox3.Text = ""
        TextBox4.Text = ""
        TextBox5.Text = ""
        i = 0
        Do While dr.Read = True
            TextBox2.Text = dr(1)
            TextBox3.Text = dr(2)
            TextBox4.Text = dr(3)
            TextBox5.Text = dr(4)
            If i = 0 Then
                i = 1
            End If
        Loop

        If i > 0 Then
            MsgBox("Record found")

        Else
            MsgBox("No record found!")
        End If

        conn.Close()
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Dim sql As String
        Dim cmd As New OleDb.OleDbCommand
        conn.Open()

        sql = "Delete * from tblRegistration WHERE ISBN='" & TextBox1.Text & "'"
        cmd.Connection = conn
        cmd.CommandText = sql

        i = cmd.ExecuteNonQuery
        If i > 0 Then
            TextBox1.Text = ""
            TextBox2.Text = ""
            TextBox3.Text = ""
            TextBox4.Text = ""
            TextBox5.Text = ""
            MsgBox("Record has been deleted successfully!")
        Else
            MsgBox("No record has been deleted!")
        End If

        conn.Close()
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        Form1.Show()
        Me.Hide()
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Form3.Show()
        Me.Hide()
    End Sub



    Private Sub Form2_Load(sender As Object, e As EventArgs) Handles MyBase.Load


    End Sub

    Private Sub Label1_Click(sender As Object, e As EventArgs) Handles Label1.Click

    End Sub

    Private Sub TextBox1_TextChanged(sender As Object, e As EventArgs) Handles TextBox1.TextChanged


    End Sub

    Private Sub TextBox2_TextChanged(sender As Object, e As EventArgs) Handles TextBox2.TextChanged

    End Sub

    Private Sub TextBox5_TextChanged(sender As Object, e As EventArgs) Handles TextBox5.TextChanged

    End Sub

    Private Sub TextBox3_TextChanged(sender As Object, e As EventArgs) Handles TextBox3.TextChanged

    End Sub
End Class
